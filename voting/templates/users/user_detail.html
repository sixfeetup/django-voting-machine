{% extends "base.html" %}
{% load static %}

{% block content %}
<div class="container">


  <div class="row">
    <div class="col-sm-12">

      <h2>{{ object.username }}</h2>
      {% if object.name %}
        <p>{{ object.name }}</p>
      {% endif %}
    </div>
  </div>



{% if object == request.user %}
   {%  for event in view.all_events.all %}
      <h3>{{ event }}</h3>
            <ol>
            {% for team in event.team_set.all %}
                <li>{{ team }}
                    {% if request.user in team.members.all %}
                        <button class="btn btn-primary" type="submit"
                                data-action="leave" data-team="{{ team.id }}">LEAVE</button>
                    {% else %}
                        <button class="btn btn-success" type="submit"
                                data-action="join" data-team="{{ team.id }}">JOIN</button>
                    {% endif %}
                </li>
            {%  endfor %}
            </ol>
      <hr>
   {%  endfor %}
<!-- Action buttons -->
{#<div class="row">#}
{#  <div class="col-sm-12">#}
{#    {% comment %}<a class="btn btn-primary" href="{% url 'users:update' %}" role="button">My Info</a> {% endcomment %}#}
{#    {% comment %}<a class="btn btn-primary" href="{% url 'account_email' %}" role="button">E-Mail</a> {% endcomment %}#}
{#    <!-- Your Stuff: Custom user template urls -->#}
{#  </div>#}
{#</div>#}
<!-- End Action buttons -->
{% endif %}

<script>
(function($) { $(function() {
    $('button').click(function(){
        $btn = $(this);
        var team_id = $(this).attr("data-team");
        var taction = $(this).attr("data-action");
         $.post('/votingmachine/event/team/' + team_id + '/' + taction + "/",
                {csrfmiddlewaretoken: '{{ csrf_token }}'},
                function(data){
                    if (data.status == 'OK') {
                        window.location.reload();
                    } else {
                        $btn.after('<span class="err-msg">' + data.message + ' ' + data.reason + '</span>');
                    }
                });
     });
}); })(jQuery);
</script>


</div>
{% endblock content %}

